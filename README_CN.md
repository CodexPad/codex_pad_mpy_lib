# 🎮 CodexPad MicroPython 库

[English](README.md)

## 项目简介

CodexPad MicroPython 库是为 CodexPad 提供的 MicroPython 驱动程序库。CodexPad 是一款自主研发的蓝牙低功耗（BLE）手柄，专为物联网设备和嵌入式系统设计。

本库支持在 ESP32/ESP32S3 及所有支持 BLE 的 MicroPython 平台上使用 CodexPad 手柄，提供了简单易用的 API 来读取手柄的按钮状态和摇杆数据。

## 特性功能

- ✅ **实时状态检测​** - 提供按下、释放、持续按住等状态检测
- ✅ **防抖动处理​** - 智能过滤摇杆微小抖动，确保数据稳定
- ✅ **可配置功率**​ - 支持调整 BLE 发射功率，平衡距离与功耗
- ✅ **多平台兼容​** - 支持 ESP32、ESP32-S系列等所有支持 BLE 的 MicroPython 设备
- ✅ **完整 API**​ - 支持所有按钮和摇杆功能

## 硬件要求

### 支持的主控芯片

- ESP32 系列
- ESP32-S2/S3 系列
- 任何支持 BLE 的 MicroPython 平台

### 所需硬件

- 手柄：CodexPad
- 支持 BLE 的 MicroPython 开发板
- USB 数据线
- 可选：外部天线（用于延长通信距离）

## MicroPython 版本要求

本库要求 MicroPython 固件版本至少为 `1.21.0`。请确保您的主机设备上运行的 MicroPython 版本符合要求。

## 🚀 快速开始

### 前置准备

#### 获取手柄的MAC地址

**重要：在使用前，您需要先获取 CodexPad 手柄的 MAC 地址**

不同型号的 CodexPad 手柄获取 MAC 地址的方法可能不同，请参考您所使用的 CodexPad 手柄的产品使用文档。

产品文档链接：[CodexPad 产品文档]()

获取到 MAC 地址后，您将需要它来进行设备连接。

#### 运行MicroPython环境

**主机设备需要先运行 MicroPython 固件**

在使用本库之前，请确保您的主机设备（如 ESP32）已经刷写了 MicroPython 固件并可以正常运行。

#### 启动手柄

启动手柄，让手柄处于待连接状态，手柄上的信号灯会持续慢闪（约1秒钟亮灭），代表等待主机连接

### 安装库文件

- 使用 Thonny、ampy 或 rshell 等工具
- 将文件 `lib/codex_pad.mpy` 上传到设备的**根目录**

### 配置并上传示例代码

- 选择需要上传的示例代码文件（位于 examples/目录）

- **重要：修改 MAC 地址配置**

    ```python
    # 将以下地址替换为您的手柄实际 MAC 地址
    codex_pad_obj.connect("E4:66:E5:A2:24:5D") # 替换为您的手柄的 MAC 地址
    ````

- 使用开发工具将文件上传到设备根目录

- 重启设备后自动运行，设备会自动连接手柄

- 连接成功后，手柄指示灯会常亮

- 操作手柄，观察设备串口输出，查看按钮和摇杆信息

## 📋 示例代码说明

示例代码中包含详细的注释说明，可以直接前往查看，此处不再对代码内容详细说明

### 基础轮询示例

- 位置：[examples/basic_polling/main.py](examples/basic_polling/main.py)
- 适用场景：​ 需要实时控制的应用，如机器人控制、实时游戏等
- 特点：​ 简单直接，适合初学者入门

### 输入状态检测示例

- 位置：[examples/state_detection/main.py](examples/state_detection/main.py)
- 适用场景：​ 需要事件驱动的应用，如菜单导航、状态切换等
- 特点：​ 响应式编程，减少不必要的轮询

## 🔧 故障排除

### 常见问题

#### Q: 如何获取 CodexPad 的 MAC 地址？

A: 请参考您所使用的 CodexPad 手柄的产品使用文档。不同型号的手柄获取 MAC 地址的方法可能不同。

#### Q: 连接失败

A: 检查以下几点：

- 检查手柄是否已启动并处于配对模式（指示灯慢闪）
- 确认 MAC 地址是否正确
- 检查设备间距离是否在有效范围内

#### Q: 无数据响应

A: 检查以下几点：

- 确认手柄连接成功（指示灯常亮）
- 检查代码中是否正确调用了 update()方法
- 查看串口输出是否有错误信息

#### Q: 响应延迟

A: 检查以下几点：

- 确保主循环中没有不必要的延迟
- update()方法需要频繁调用

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。

---

*CodexPad - 让嵌入式开发更简单*
